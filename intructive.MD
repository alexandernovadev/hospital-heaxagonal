# DocumentaciÃ³n TÃ©cnica: Sistema de Hospital con DDD y Arquitectura Hexagonal

## ğŸ“‹ Ãndice
1. [Arquitectura General](#arquitectura-general)
2. [Contextos Delimitados (Bounded Contexts)](#contextos-delimitados)
3. [Agregados y Entidades](#agregados-y-entidades)
4. [Value Objects](#value-objects)
5. [Servicios de Dominio](#servicios-de-dominio)
6. [Eventos de Dominio](#eventos-de-dominio)
7. [Sistema de AutenticaciÃ³n](#sistema-de-autenticaciÃ³n)
8. [Estructura del Proyecto](#estructura-del-proyecto)

---

## ğŸ—ï¸ Arquitectura General

**Arquitectura Hexagonal con DDD** organizada en mÃ³dulos por contexto delimitado.

```
src/
â”œâ”€â”€ core/                          # Dominio Principal (Core Domain)
â”œâ”€â”€ support/                       # Subdominios de Soporte
â”œâ”€â”€ shared/                        # Kernel Compartido
â””â”€â”€ apps/                          # Puntos de Entrada
```

---

## ğŸ§­ Contextos Delimitados

### 1. **GestiÃ³n de Citas (Appointment Management)**
- **Responsabilidad**: ProgramaciÃ³n y gestiÃ³n de citas mÃ©dicas
- **Agregado Principal**: `Appointment`
- **Lenguaje Ubicuo**: Cita, ProgramaciÃ³n, Disponibilidad

### 2. **Urgencias y Emergencias (Emergency Care)**
- **Responsabilidad**: AtenciÃ³n de casos urgentes y triaje
- **Agregado Principal**: `EmergencyEpisode`
- **Lenguaje Ubicuo**: Triaje, Episodio, Urgencia

### 3. **Historia ClÃ­nica (Medical Records)**
- **Responsabilidad**: GestiÃ³n integral de historiales mÃ©dicos
- **Agregado Principal**: `MedicalRecord`
- **Lenguaje Ubicuo**: DiagnÃ³stico, Tratamiento, Historial

### 4. **GestiÃ³n de Recursos (Resource Management)**
- **Responsabilidad**: AdministraciÃ³n de habitaciones, camas y personal
- **Agregados Principales**: `Room`, `Bed`, `Doctor`, `Nurse`
- **Lenguaje Ubicuo**: HabitaciÃ³n, Cama, Turno, Especialidad

### 5. **FacturaciÃ³n (Billing)**
- **Responsabilidad**: GestiÃ³n de facturas y pagos
- **Agregado Principal**: `Invoice`
- **Lenguaje Ubicuo**: Factura, Pago, Concepto

### 6. **AutenticaciÃ³n y AutorizaciÃ³n (Auth)**
- **Responsabilidad**: GestiÃ³n de usuarios y permisos
- **Agregados Principales**: `User`, `Role`, `Permission`
- **Lenguaje Ubicuo**: Usuario, Rol, Permiso, AutenticaciÃ³n

---

## ğŸ§© Agregados y Entidades

### Core Domain
| Entidad | Contexto | Responsabilidad |
|---------|----------|-----------------|
| `Patient` | Todos | Representa a un paciente del sistema |
| `Appointment` | Citas | Gestiona las citas programadas |
| `EmergencyEpisode` | Urgencias | Maneja episodios de emergencia |
| `MedicalRecord` | Historia ClÃ­nica | Contiene el historial mÃ©dico completo |

### Support Subdomains
| Entidad | Contexto | Responsabilidad |
|---------|----------|-----------------|
| `Doctor` | Recursos | Personal mÃ©dico con especialidades |
| `Nurse` | Recursos | Personal de enfermerÃ­a |
| `Room` | Recursos | Habitaciones del hospital |
| `Bed` | Recursos | Camas asignables |
| `Invoice` | FacturaciÃ³n | Facturas y cargos |

### Authentication
| Entidad | Contexto | Responsabilidad |
|---------|----------|-----------------|
| `User` | Auth | Usuarios del sistema |
| `Role` | Auth | Roles de permisos |
| `Permission` | Auth | Permisos especÃ­ficos |

---

## ğŸ¯ Value Objects

### Identificadores
- `PatientId`, `AppointmentId`, `EmergencyEpisodeId`, `MedicalRecordId`
- `DoctorId`, `NurseId`, `RoomId`, `BedId`, `InvoiceId`
- `UserId`, `RoleId`, `PermissionId`

### Datos Personales
- `FullName` (Nombre + Apellido)
- `DateOfBirth` (Fecha nacimiento)
- `DNI` (Documento identidad)
- `ContactInfo` (Email + TelÃ©fono)
- `Address` (DirecciÃ³n completa)

### MÃ©dicos
- `AppointmentStatus` (Programada/Confirmada/Cancelada/Completada)
- `TimeSlot` (Franja horaria)
- `AppointmentType` (Tipo de cita)
- `TriageLevel` (Nivel de urgencia)
- `PainScale` (Escala dolor 0-10)
- `VitalSigns` (Signos vitales)
- `BloodType` (Grupo sanguÃ­neo)
- `Allergies` (Alergias)

### Recursos
- `Specialty` (Especialidad mÃ©dica)
- `Shift` (Turno de trabajo)
- `LicenseNumber` (NÃºmero colegiado)
- `RoomNumber` (NÃºmero habitaciÃ³n)
- `RoomType` (Tipo habitaciÃ³n)
- `RoomStatus` (Estado habitaciÃ³n)

### FacturaciÃ³n
- `InvoiceStatus` (Estado factura)
- `Currency` (Moneda)
- `InvoiceItem` (Concepto factura)
- `Money` (Cantidad + moneda)

### AutenticaciÃ³n
- `Username` (Nombre usuario)
- `PasswordHash` (Hash contraseÃ±a)
- `JWTToken` (Token JWT)
- `RefreshToken` (Token refresco)

---

## âš™ï¸ Servicios de Dominio

### GestiÃ³n de Citas
- `AppointmentSchedulerService`: Coordina la programaciÃ³n de citas

### Urgencias
- `TriageService`: Gestiona el proceso de triaje
- `EmergencyCoordinatorService`: Coordina recursos en urgencias

### Historia ClÃ­nica
- `MedicalRecordService`: Gestiona historiales mÃ©dicos

### Recursos
- `RoomAssignmentService`: Asigna habitaciones y camas
- `StaffAssignmentService`: Gestiona asignaciÃ³n de personal

### FacturaciÃ³n
- `BillingService`: Genera y gestiona facturas
- `PaymentProcessingService`: Procesa pagos

### AutenticaciÃ³n
- `AuthenticationService`: Gestiona autenticaciÃ³n
- `AuthorizationService`: Gestiona autorizaciÃ³n
- `PasswordService`: Gestiona contraseÃ±as
- `TokenService`: Gestiona tokens JWT

---

## ğŸ“¢ Eventos de Dominio

### Pacientes y Citas
- `PatientRegisteredEvent`
- `AppointmentScheduledEvent`
- `AppointmentCancelledEvent`

### Urgencias
- `EmergencyAdmissionEvent`
- `TriageCompletedEvent`
- `DiagnosisMadeEvent`
- `TreatmentPrescribedEvent`

### Tratamientos
- `MedicationAdministeredEvent`
- `LabResultsReadyEvent`
- `PatientDischargedEvent`

### Recursos
- `RoomAssignedEvent`
- `SurgeryScheduledEvent`

### FacturaciÃ³n
- `InvoiceGeneratedEvent`
- `PaymentReceivedEvent`

### AutenticaciÃ³n
- `UserRegisteredEvent`
- `UserLoggedInEvent`
- `UserPasswordChangedEvent`
- `RoleAssignedEvent`

---

## ğŸ” Sistema de AutenticaciÃ³n

### Entidades
- `User`: Usuarios del sistema
- `Role`: Roles de permisos
- `Permission`: Permisos especÃ­ficos

### Value Objects
- `UserId`, `RoleId`, `PermissionId`
- `Username`, `PasswordHash`, `Email`
- `JWTToken`, `RefreshToken`

### Servicios
- `AuthenticationService`: Login/logout
- `AuthorizationService`: Control de acceso
- `PasswordService`: Hashing de contraseÃ±as
- `TokenService`: GestiÃ³n de tokens

### Eventos
- `UserRegisteredEvent`
- `UserLoggedInEvent`
- `UserPasswordChangedEvent`
- `RoleAssignedEvent`
- `PermissionGrantedEvent`

### PolÃ­ticas
- `PasswordComplexityPolicy`: Reglas complejidad contraseÃ±as
- `TokenExpirationPolicy`: ExpiraciÃ³n de tokens
- `RoleBasedAccessPolicy`: Control acceso por roles

---

## ğŸ“ Estructura del Proyecto

```
src/
â”œâ”€â”€ core/
â”‚   â”œâ”€â”€ appointment/               # Contexto: Citas
â”‚   â”œâ”€â”€ emergency/                 # Contexto: Urgencias
â”‚   â”œâ”€â”€ medical-record/           # Contexto: Historia ClÃ­nica
â”‚   â””â”€â”€ patient/                  # Contexto: Pacientes
â”œâ”€â”€ support/
â”‚   â”œâ”€â”€ billing/                  # Contexto: FacturaciÃ³n
â”‚   â”œâ”€â”€ resource/                 # Contexto: Recursos
â”‚   â””â”€â”€ auth/                     # Contexto: AutenticaciÃ³n
â”œâ”€â”€ shared/
â”‚   â”œâ”€â”€ domain/                   # VO compartidos
â”‚   â”œâ”€â”€ infrastructure/           # Utilidades compartidas
â”‚   â””â”€â”€ kernel/                   # Kernel compartido
â””â”€â”€ apps/
    â”œâ”€â”€ api/                      # API REST
    â”œâ”€â”€ worker/                   # Background workers
    â””â”€â”€ cli/                      # Herramientas CLI
```

---

## ğŸš€ PrÃ³ximos Pasos para Desarrollo

1. **Configurar estructura de proyectos** con los mÃ³dulos descritos
2. **Implementar Shared Kernel** con VOs base
3. **Cear contextos delimitados** como mÃ³dulos independientes
4. **Implementar agregados principales** (Patient, Appointment, etc.)
5. **Desarrollar servicios de dominio** para cada contexto
6. **Configurar sistema de eventos** entre contextos
7. **Implementar autenticaciÃ³n** como contexto separado
8. **Crear APIs** para cada contexto delimitado

Cada contexto debe ser desarrollado como un mÃ³dulo independiente con su propia capa de aplicaciÃ³n, dominio e infraestructura.